{% extends "base.html" %}

{% block title %}Access Denied - Geographic Restriction{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card border-danger shadow-lg">
                <div class="card-header bg-danger text-white">
                    <h3 class="mb-0">
                        <i class="bi bi-geo-alt-fill"></i> Access Denied - Geographic Restriction
                    </h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-danger" role="alert">
                        <h4 class="alert-heading">
                            <i class="bi bi-exclamation-triangle-fill"></i> Access from Your Location is Not Permitted
                        </h4>
                        <hr>
                        <p class="mb-0"><strong>Reason:</strong> {{ reason }}</p>
                    </div>
                    
                    <h5 class="mt-4">Access Details:</h5>
                    <table class="table table-bordered">
                        <tr>
                            <th width="30%">Your IP Address:</th>
                            <td><code>{{ ip_address }}</code></td>
                        </tr>
                        <tr>
                            <th>Detected Location:</th>
                            <td>
                                {% if city %}{{ city }}, {% endif %}
                                <strong>{{ country }}</strong>
                            </td>
                        </tr>
                        <tr>
                            <th>Time:</th>
                            <td>{{ request.timestamp|default:"now" }}</td>
                        </tr>
                    </table>
                    
                    <div class="alert alert-info mt-4">
                        <h5><i class="bi bi-info-circle-fill"></i> Why is this happening?</h5>
                        <p>For security reasons, our fire department intranet only allows access from within the United States. This helps protect sensitive department information and member data.</p>
                    </div>
                    
                    <div class="card mt-4 border-warning">
                        <div class="card-header bg-warning">
                            <h5 class="mb-0"><i class="bi bi-airplane-fill"></i> Traveling or Deployed?</h5>
                        </div>
                        <div class="card-body">
                            <p>If you are traveling internationally or deployed and need to access the system, you can request a temporary international access exception.</p>
                            
                            <h6>How to Request Access:</h6>
                            <ol>
                                <li>Contact the IT team at <a href="mailto:it@yourfiredept.org">it@yourfiredept.org</a></li>
                                <li>Provide your travel dates and destination country</li>
                                <li>Explain why you need access during your travel</li>
                                <li>IT will review and approve if appropriate</li>
                            </ol>
                            
                            <p class="mb-0">
                                <strong>Note:</strong> Approval typically takes 24-48 hours. Please plan ahead if you know you'll be traveling.
                            </p>
                        </div>
                    </div>
                    
                    <div class="card mt-4 border-danger">
                        <div class="card-header bg-danger text-white">
                            <h5 class="mb-0"><i class="bi bi-shield-exclamation"></i> Didn't Expect This?</h5>
                        </div>
                        <div class="card-body">
                            <p><strong>If you are NOT traveling and see this message:</strong></p>
                            <ul>
                                <li>Your account may be compromised</li>
                                <li>Someone may be attempting to access your account</li>
                                <li>You may be using a VPN that routes through another country</li>
                            </ul>
                            
                            <p class="mb-0">
                                <strong class="text-danger">IMMEDIATE ACTION REQUIRED:</strong>
                            </p>
                            <ol>
                                <li>Change your password immediately (from a secure location)</li>
                                <li>Contact IT Security: <a href="mailto:security@yourfiredept.org">security@yourfiredept.org</a></li>
                                <li>If using a VPN, disconnect and try again</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <a href="{% url 'logout' %}" class="btn btn-danger btn-lg">
                            <i class="bi bi-box-arrow-right"></i> Logout
                        </a>
                    </div>
                    
                    <hr class="my-4">
                    
                    <div class="text-muted small">
                        <p><strong>Security Information:</strong></p>
                        <ul class="mb-0">
                            <li>This access attempt has been logged for security purposes</li>
                            <li>Repeated attempts from non-US locations will trigger security alerts</li>
                            <li>IT staff have been notified of this access attempt</li>
                            <li>All geographic access controls are audited for compliance</li>
                        </ul>
                    </div>
                </div>
                <div class="card-footer text-muted text-center">
                    <small>
                        <i class="bi bi-shield-check"></i> Protected by Geographic Access Control System
                        <br>
                        For assistance: <a href="mailto:it@yourfiredept.org">it@yourfiredept.org</a> | 
                        Phone: (555) 123-4567
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        animation: fadeIn 0.5s;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
{% endblock %}
